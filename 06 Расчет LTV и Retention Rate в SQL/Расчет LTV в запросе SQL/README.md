# Когортный анализ. Расчет LTV в запросе SQL
## Рассчитаем LTV в запросе SQL за 2009 за первые шесть месяцев с момента регистрации пользователя
- Создадим профиль пользователя. 
- Возьмем 2019г, пользователи с 1й покупкой

- Определим лайфтайм для каждой покупки и месяц регистрации пользователя.
- Добавим суммарную стоимость заказов с накоплением для каждого пользователя.

### ER-диаграмма

![ER-диаграмма](https://user-images.githubusercontent.com/96660385/172518734-a929614c-1e3e-475b-b7ff-dad197e7ce33.png)
