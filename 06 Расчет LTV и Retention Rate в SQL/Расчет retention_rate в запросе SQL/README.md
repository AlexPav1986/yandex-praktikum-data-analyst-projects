# Когортный анализ. Расчет Retention Rate в запросе SQL

- Определим профиль пользователя: выведем список идентификаторов клиентов, которые совершили хотя бы одну покупку.
- Добавим месяц первого события. Эта дата будет началом когорты.
- Определим, было ли у пользователей хотя бы одно событие в каждом месяце. Для этого напишите запрос, который выведет все уникальные комбинации user_id и значения месяца события для выбранных пользователей.
- Найдем общее количество пользователей для каждой когорты.
- Объединим все данные и рассчитаем Retention Rate.

### ER-диаграмма

![ER-диаграмма](https://user-images.githubusercontent.com/96660385/172524179-c967b153-2f75-4e6e-81cb-491b610b93dc.png)
